# Проект обнаружение VPN соединений

Наиболее [актуальные](./models/interval-27-30-reality-0_915) версии моделей поддерживает детекцию протокола [xtls-reality](https://github.com/XTLS/Xray-core)

## Описание текущих исследований
[Данные](./vpn-pcap) были извлечены из реального трафика собранного приложениями: [xray-windows/xray-linux](https://github.com/XTLS/Xray-core/releases), [v2rayng-android](https://github.com/2dust/v2rayNG/releases), [FoXray](https://foxray.org/)

Подробнее ознакомится с фичами можно из исходного [кода](./core/feature)

ModelPipeline:
1) Скейлинг данных и нормализация данных (приведение к нормальному распределению) -- yeo-johnson PowerTransformer поскольку имеются нулевые значения признаков.
2) Декомпозиция данных -- FastICA был взять за основу, поскольку данный метод не зацикливается на линейности и многомерной нормальности исходных признаков. Признаки даже после применения PowerTransformer() не всегда соотвествуют нормальному распределению.
3) Классификация данных -- RandomForest и GradientBoosting показывают наиболее лучшие результаты с FastICA

Рассматривались также:
- StandardScaler, но показал хуже результаты с FastICA и PCA (поскольку данные были не нормализованы)
- PCA не пременим в нашем случае в чистом виде, поскольку исходные данные не подразумевают многомерной нормальности, а преобразование PowerTransformer не решает полностью проблему многомерной нормальности
- PCA + FastICA комбинация также не применима, поскольку фильтрация признаков относительно их корреляции отбрасывает информацию о незовисимости компонент, тем самым ухудшая результаты классификации

Одна из преимущественных идей использовать FastICA, который может помочь в разложении мультеплексированных VPN потоков по независимым компонентам и тем самым увеличить точность детектирования.

## TODO
- [] Реализовать пайплайн моделей детекции (классификация сразу нескольких протоколов)
- [] Отрефакторить ModelPipeline: фильтрация входных фреймов на этапе predict и добавить возможность создавать любое количество трансформеров
- [] Рассмотреть повышение точности предсказания на основе двунаправленных LSTM
- [] Рассмотреть возможность добавление направленных признаков
- [] Рассмотреть сдвиг данных и нормализация данных box-cox
- [] Рассмотреть возможность добавить определение типа контента передаваемого в рамках потока
- [] Рассмотреть возможность добавить определение типа протокола использованного для организации VPN
- [] Проверить идею про разложение мультеплексированного трафика VPN
